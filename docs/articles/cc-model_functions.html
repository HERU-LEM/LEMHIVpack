<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2 Model Functions • LEMHIVpack</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="2 Model Functions">
<meta property="og:description" content="LEMHIVpack">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LEMHIVpack</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/aa-introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/bb-model_inputs.html">1 Model Inputs</a>
    </li>
    <li>
      <a href="../articles/cc-model_functions.html">2 Model Functions</a>
    </li>
    <li>
      <a href="../articles/dd-interventions.html">3 Interventions</a>
    </li>
    <li>
      <a href="../articles/ee-run_model.html">4 Run Model</a>
    </li>
    <li>
      <a href="../articles/ff-analysis.html">5 Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HERU-LEM/LEMpackHIV/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="cc-model_functions_files/header-attrs-2.3.3/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>2 Model Functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HERU-LEM/LEMpackHIV/blob/master/vignettes/cc-model_functions.Rmd"><code>vignettes/cc-model_functions.Rmd</code></a></small>
      <div class="hidden name"><code>cc-model_functions.Rmd</code></div>

    </div>

    
    
<p>This section describes the basic functions of the dynamic, compartmental HIV transmission model. For further details, see <span class="citation">(Zang et al. 2020; Krebs et al. 2020)</span>.</p>
<p><span class="math inline">\(~\)</span></p>
<div id="force-of-hiv-infection" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#force-of-hiv-infection" class="anchor"></a>2.0 Force of HIV infection</h1>
<p>In this component, we estimate the Force of Infection (FoI), which is the rate at which susceptible individuals become infected in the population and is a function of many different parameters. A list of FoI parameters are provided in Table 2.1.</p>
<p><strong>Table 2.1: Description of FoI parameters with their <code>R</code> names</strong></p>
<table class="table">
<thead><tr class="header">
<th align="left"><strong>R name</strong></th>
<th align="center"><strong>Description</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>y</code></td>
<td align="center">Number of individuals in each compartment</td>
</tr>
<tr class="even">
<td align="left"><code>no</code></td>
<td align="center">Number of opposite sexual partners for each compartment</td>
</tr>
<tr class="odd">
<td align="left"><code>uoC</code></td>
<td align="center">Condom use adjustment term for opposite sex</td>
</tr>
<tr class="even">
<td align="left"><code>ns</code></td>
<td align="center">Number of same sexual partners for each compartment</td>
</tr>
<tr class="odd">
<td align="left"><code>usC</code></td>
<td align="center">Condom use adjustment term for same sex</td>
</tr>
<tr class="even">
<td align="left"><code>e0</code></td>
<td align="center">Assortative coefficient for heterosexual mixing between ethnic groups</td>
</tr>
<tr class="odd">
<td align="left"><code>eS</code></td>
<td align="center">Assortative coefficient for homosexual mixing between ethnic groups</td>
</tr>
<tr class="even">
<td align="left"><code>sigmaFM</code></td>
<td align="center">Probability of transmission by F-&gt;M for 16 HIV+ states</td>
</tr>
<tr class="odd">
<td align="left"><code>sigmaMF</code></td>
<td align="center">Probability of transmission by M-&gt;F for 16 HIV+ states</td>
</tr>
<tr class="even">
<td align="left"><code>sigmaM</code></td>
<td align="center">Probability of transmission by same sex for 16 HIV+ states</td>
</tr>
<tr class="odd">
<td align="left"><code>tau</code></td>
<td align="center">Probability of transmission by injection for 16 HIV+ states</td>
</tr>
<tr class="even">
<td align="left"><code>eff.prep</code></td>
<td align="center">Percentage reduction in risk of infection for PrEP</td>
</tr>
<tr class="odd">
<td align="left"><code>d</code></td>
<td align="center">Number of injections</td>
</tr>
<tr class="even">
<td align="left"><code>s</code></td>
<td align="center">Proportion of injections that are shared</td>
</tr>
<tr class="odd">
<td align="left"><code>eff.oat</code></td>
<td align="center">Percent reduction in # of shared injections reduced to OAT</td>
</tr>
<tr class="even">
<td align="left"><code>cov.ssp</code></td>
<td align="center">Coverage of syringe services programs</td>
</tr>
</tbody>
</table>
<p>Our model captures HIV transmission between susceptible and infected individuals via heterosexual contact, homosexual contact and needle-sharing. The effects of sexual mixing patterns (assortative and proportional partnership mixing) and sexual risk behavior (ie. condom use, number of partners) are also accounted for. Consistent with prior studies, we allowed men who have sex with men (MSM) to potentially have heterosexual contact with women. To calculate FoI, we determine a mixing matrix and calculate the mixing probability between subgroups. That is to say, the transmission between susceptible and infected individuals is represented as a matrix which considers the sufficient contact rate between members of susceptible compartments and members of infected compartments. Groups represent opposite sexes and are defined by race/ethnicity and sexual risk level (high or low). To avoid over-mixing between high- and low-risk populations (which may cause an overestimation of heterosexual transmission), the mixing probability between high-and low-risk individuals is restricted to 1% (proportionately) of partnerships formed.</p>
<p><span class="math inline">\(~\)</span></p>
</div>
<div id="nonlinear-ordinary-differential-equations-ode-functions" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#nonlinear-ordinary-differential-equations-ode-functions" class="anchor"></a>2.1 Nonlinear Ordinary Differential Equations (ODE functions)</h1>
<p>We constructed a system of nonlinear ordinary differential equations (ODEs) to capture movement between 19 base model states for each of the 42 population groups considered in our model (refer to figures in <em>Introduction</em> section) . The complete model is thus comprised of 798 equations (42 population groups 19 states). A list of ODE parameters are provided in Table 2.2.</p>
<p><span class="math inline">\(~\)</span></p>
<p><strong>Table 2.2: Description of ODE parameters and their <code>R</code> names</strong></p>
<table class="table">
<colgroup>
<col width="28%">
<col width="71%">
</colgroup>
<thead><tr class="header">
<th align="left"><strong>R name</strong></th>
<th align="center"><strong>Description</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><em>ODE parameters for all groups</em></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left"><code>x</code></td>
<td align="center">a vector containing the number of individuals in each HIV state</td>
</tr>
<tr class="odd">
<td align="left"><code>lambda</code></td>
<td align="center">Sufficient contact rate between individuals</td>
</tr>
<tr class="even">
<td align="left"><code>lambda.p</code></td>
<td align="center">Sufficient contact rate for individuals on PrEP</td>
</tr>
<tr class="odd">
<td align="left"><code>rho</code></td>
<td align="center">Entry rate (assume the same for all groups)</td>
</tr>
<tr class="even">
<td align="left"><code>1/ws</code></td>
<td align="center">Average duration uninfected individuals in compartment S remain (as identified after screening)</td>
</tr>
<tr class="odd">
<td align="left"><code>1/wp</code></td>
<td align="center">Average duration uninfected individuals in compartment S<sub>p</sub> remain on PrEP</td>
</tr>
<tr class="even">
<td align="left"><code>mu_mat</code></td>
<td align="center">Maturation rates (age&gt;65)</td>
</tr>
<tr class="odd">
<td align="left"><code>mo</code></td>
<td align="center">Mortality rates for 19 states</td>
</tr>
<tr class="even">
<td align="left"><code>psi</code></td>
<td align="center">Screening rates for susceptible or infected</td>
</tr>
<tr class="odd">
<td align="left"><code>psi.p</code></td>
<td align="center">Screening rates for I<sub>ap</sub> (acute HIV on PrEP)</td>
</tr>
<tr class="even">
<td align="left"><code>theta.ai</code></td>
<td align="center">Transition rate from acute states (I<sub>a</sub>) to chronic state (CD4&gt;=500; I<sub>1</sub>)</td>
</tr>
<tr class="odd">
<td align="left"><code>theta.ad</code></td>
<td align="center">Transition rate from acute states (D<sub>a</sub>) to chronic state (CD4&gt;=500; D<sub>1</sub>)</td>
</tr>
<tr class="even">
<td align="left"><code>phi</code></td>
<td align="center">Percent of infected of people receiving ART once diagnosed</td>
</tr>
<tr class="odd">
<td align="left">
<code>v2</code>,<code>v3</code>
</td>
<td align="center">symptom-based case finding rate for I<sub>2</sub> and I<sub>3</sub>, respectively</td>
</tr>
<tr class="even">
<td align="left"><code>alpha</code></td>
<td align="center">ART initiation rate for D<sub>1</sub>,D<sub>2</sub>, and D<sub>3</sub>
</td>
</tr>
<tr class="odd">
<td align="left"><code>alpha.re</code></td>
<td align="center">ART re-initiation rate for O<sub>1</sub>,O<sub>2</sub>, and O<sub>3</sub>
</td>
</tr>
<tr class="even">
<td align="left"><code>theta.1</code></td>
<td align="center">HIV disease progression rate for those not on ART, from I<sub>1</sub>/D<sub>1</sub> to I<sub>2</sub>/D<sub>2</sub>
</td>
</tr>
<tr class="odd">
<td align="left"><code>theta.2</code></td>
<td align="center">HIV disease progression rate for those not on ART, from I<sub>2</sub>/D<sub>2</sub> to I<sub>3</sub>/D<sub>3</sub>
</td>
</tr>
<tr class="even">
<td align="left"><code>theta.t</code></td>
<td align="center">transition probabilities for those on ART</td>
</tr>
<tr class="odd">
<td align="left"><code>theta.o</code></td>
<td align="center">ART dropout probability from states T<sub>1</sub>,T<sub>2</sub>,T<sub>3</sub>
</td>
</tr>
<tr class="even">
<td align="left"><code>eta</code></td>
<td align="center">PrEP entry rate</td>
</tr>
<tr class="odd">
<td align="left"><em>Additional ODE parameters for PWID</em></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left"><code>x.offoat</code></td>
<td align="center">a vector containing # of individuals off OAT</td>
</tr>
<tr class="odd">
<td align="left"><code>oat.e</code></td>
<td align="center">OAT entry rate</td>
</tr>
<tr class="even">
<td align="left"><code>oat.q</code></td>
<td align="center">OAT dropout rate</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(~\)</span></p>
<p>Note that opioid agonist treatment (OAT) was only available to all PWID and MSM-PWID. As such, the model ODE equations are grouped for MSM and Heterosexual HIV risk groups (non-PWID), PWID and MSM-PWID receiving OAT, and PWID and MSM-PWID non receiving OAT; corresponding R scripts are <code>ode.list</code>, <code>ode.list.OAT</code>, and <code>ode.list.offOAT</code> respectively, found in <code>LEMHIVpack</code> and the <a href="https://github.com/benenns/LEMpackTEST/tree/master/R"><em>R</em></a> directory of the LEMHIVpack github repository.</p>
<p><span class="math inline">\(~\)</span></p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references hanging-indent">
<div id="ref-interventions">
<p>Krebs, E., X. Zang, B. Enns, J. E. Min, C. N. Behrends, C. Del Rio, J. C. Dombrowski, et al. 2020. “The Impact of Localized Implementation: Determining the Cost-Effectiveness of Hiv Prevention and Care Interventions Across Six United States Cities.” Journal Article. <em>AIDS</em> 34 (3): 447–58. <a href="https://doi.org/10.1097/QAD.0000000000002455">https://doi.org/10.1097/QAD.0000000000002455</a>.</p>
</div>
<div id="ref-calibration">
<p>Zang, X., E. Krebs, J. E. Min, A. Pandya, B. D. L. Marshall, B. R. Schackman, C. N. Behrends, D. J. Feaster, B. Nosyk, and Localized HIV Modeling Study Group. 2020. “Development and Calibration of a Dynamic Hiv Transmission Model for 6 Us Cities.” Journal Article. <em>Med Decis Making</em> 40 (1): 3–16. <a href="https://doi.org/10.1177/0272989X19889356">https://doi.org/10.1177/0272989X19889356</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Xiao Zang, Emanuel Krebs, Benjamin Enns, Jeong Min, Siyuan Chen, Amanda My Linh Quan, Bohdan Nosyk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
